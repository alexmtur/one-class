<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../web-animations-js/web-animations.min.html">

<dom-module id="one-navbar-item">
    <template>
        <style>
        :host{
            display: flex;
        }
        </style>
    </template>
    <script>
        class OneClass extends Polymer.Element {
            static get is() { return "one-class"; }
            static get properties() {
                return {
                    animations: {
                        type: Object,
                        value: {
                            'fade-in': [
                                {opacity: 0},
                                {opacity: 1}
                            ],
                            'fade-in-left': [
                                {opacity: 0, transform: 'translate3d(-100%, 0, 0)'},
                                {opacity: 1, transform: 'none'}
                            ],
                            'fade-in-right': [
                                {opacity: 0, transform: 'translate3d(100%, 0, 0)'},
                                {opacity: 1, transform: 'none'}
                            ],
                            'fade-out': [
                                {opacity: 1},
                                {opacity: 0}
                            ],
                            'fade-out-left': [
                                {opacity: 0, transform: 'none'},
                                {opacity: 1, transform: 'translate3d(-100%, 0, 0)'}
                            ],
                            'fade-out-right': [
                                {opacity: 0, transform: 'none'},
                                {opacity: 1, transform: 'translate3d(100%, 0, 0)'}
                            ],
                            'slide-in-left': [
                                {transform: 'translate3d(-100%, 0, 0)'},
                                {transform: 'none'}
                            ],
                            'slide-in-right': [
                                {transform: 'translate3d(100%, 0, 0)'},
                                {transform: 'none'}
                            ],
                            'slide-in-up': [
                                {transform: 'translate3d(0, 100%, 0)'},
                                {transform: 'none'}
                            ],
                            'slide-in-down': [
                                {transform: 'translate3d(0, -100%, 0)'},
                                {transform: 'none'}
                            ],
                            'slide-out-left': [
                                {transform: 'none'},
                                {transform: 'translate3d(-100%, 0, 0)'}
                            ],
                            'slide-out-right': [
                                {transform: 'none'},
                                {transform: 'translate3d(100%, 0, 0)'}
                            ],
                            'slide-out-up': [
                                {transform: 'none'},
                                {transform: 'translate3d(0, -100%, 0)'}
                            ],
                            'slide-out-down': [
                                {transform: 'none'},
                                {transform: 'translate3d(0, 100%, 0)'}
                            ],
                            'expand': [
                                {transform: 'scale(0)'}, //, maxHeight: "0"
                                {transform: 'scale(1.3)'},
                                {transform: 'scale(1)'} //, maxHeight: "100px"
                            ],
                            'shrink': [
                                {transform: 'scale(1)'}, //, maxHeight: "0"
                                {transform: 'scale(0)'} //, maxHeight: "100px"
                            ],
                            'vertical-expand': [
                                {transform: 'scaleY(0)'}, //, maxHeight: "0"
                                {transform: 'none'} //, maxHeight: "100px"
                            ],
                            'vertical-shrink': [
                                {transform: 'none'}, //, maxHeight: "0"
                                {transform: 'scaleY(0)'} //, maxHeight: "100px"
                            ],
                            'horizontal-expand': [
                                {transform: 'scaleX(0)'}, //, maxHeight: "0"
                                {transform: 'none'} //, maxHeight: "100px"
                            ],
                            'horizontal-shrink': [
                                {transform: 'none'}, //, maxHeight: "0"
                                {transform: 'scaleX(0)'} //, maxHeight: "100px"
                            ],
                        }
                    },
                    visible: {
                        type: Boolean,
                        value: true,
                        reflectToAttribute: true,
                        notify: true,
                        observer: '_visibleChanged'
                    },
                    entryAnimation: {
                        type: String
                    },
                    exitAnimation: {
                        type: String
                    },
                    overlapAnimation: {
                        type: Boolean,
                        value: false
                    },
                    initialDisplay: {
                        type: String,
                        value: 'initial'
                    }
                    //entryKeyframes, exitKeyframes for more customization
                };
            }
            _visibleChanged(newValue, oldValue) {
                if(newValue === undefined) return;
                else if(oldValue === undefined && newValue) {
                    this.initialDisplay = this.style.display;
                }
                else if(oldValue === undefined && !newValue) {
                    this.initialDisplay = this.style.display;
                    this.style.display = "none";
                } 
                else if(newValue) {
                    //Pass an argument for the type of display? Or maybe save it on hide
                    // console.log('display: ' + this.style.display);
                    this.style.display = this.initialDisplay;
                    if(this.entryAnimation) {
                        if(this.overlapAnimation) this.style.position = "absolute";
                        this.animationController = this.animate(this.animations[this.entryAnimation], {duration: 300, easing: 'ease-in-out'});
                        this.animationController.onfinish = () => {
                            if(this.overlapAnimation) this.style.position = "initial";
                        };
                    }
                }
                else if(!newValue) {
                    if(this.exitAnimation){
                        if(this.overlapAnimation) this.style.position = "absolute";
                        this.animationController = this.animate(this.animations[this.exitAnimation], {duration: 300, easing: 'ease-in-out'});
                        this.animationController.onfinish = () => {this.style.display = "none";};
                        if(this.overlapAnimation) this.style.position = "absolute";
                    }
                    else {
                        this.style.display = "none";
                    }
                }
            }
            show() {
                this.visible = true;
            }
            hide() {
                this.visible = false;
            }
            toggle() {
                this.visible = !this.visible;
            }
        }
        customElements.define(OneClass.is, OneClass);
    </script>
</dom-module>